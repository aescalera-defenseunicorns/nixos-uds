kind: UDSBundle
metadata:
  name: demo-bundle
  description: Bundle with Zarf init and UDS Core.
  version: 0.0.1

variables:
  metallb:
    IP_ADDRESS_ADMIN_INGRESSGATEWAY: "192.168.122.26"
    IP_ADDRESS_TENANT_INGRESSGATEWAY: "192.168.122.205"

packages:
  - name: init
    # repository: oci://ghcr.io/zarf-dev/packages/init
    path: ./
    ref: v0.55.6

  - name: metallb
    # repository: oci://ghcr.io/uds-packages/metallb
    path: ./
    ref: 0.15.2 # -uds.0-upstream
    overrides:
      metallb:
        metallb:
          variables:
            - path: addresspools.adminIngress.ipAddressPool
              name: IP_ADDRESS_ADMIN_INGRESSGATEWAY
              default: ${ZARF_VAR_IP_ADDRESS_ADMIN_INGRESSGATEWAY}
            - path: addresspools.tenantIngress.ipAddressPool
              name: IP_ADDRESS_TENANT_INGRESSGATEWAY
              default: ${ZARF_VAR_IP_ADDRESS_TENANT_INGRESSGATEWAY}

  - name: core
    # repository: oci://ghcr.io/defenseunicorns/packages/uds/core
    path: ./
    ref: 0.44.0 # -upstream
    # Set overrides for Keycloak SSO tutorial
    overrides:
      keycloak:
        keycloak:
          variables:
            - name: INSECURE_ADMIN_PASSWORD_GENERATION
              description: "Generate an insecure admin password for dev/test"
              path: insecureAdminPasswordGeneration.enabled
              default: "true"

